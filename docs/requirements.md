# 요구사항 정의서

> 군 피복 구매관리 시스템 요구사항 명세서

## 1. 개요

### 1.1 목적

본 문서는 군 피복 구매관리 시스템의 기능적, 비기능적 요구사항을 정의한다.

### 1.2 범위

- 사용자 관리 및 인증
- 포인트 지급 및 관리
- 피복 품목 관리
- 온라인/오프라인 구매
- 재고 관리
- 체척권 관리
- 통계 및 대시보드

### 1.3 용어 정의

| 용어 | 정의 |
|------|------|
| 포인트 | 피복 구매를 위한 가상 화폐 |
| 체척권 | 맞춤피복 구매용 교환권 |
| 완제품 | 규격화된 피복 품목 |
| 맞춤피복 | 개인 맞춤 제작 피복 |

---

## 2. 사용자 역할 및 권한

### 2.1 역할 정의

| 역할 | 코드 | 설명 |
|------|------|------|
| 군수담당자 | admin | 시스템 전체 관리 |
| 피복판매소담당자 | sales_office | 판매소 운영 관리 |
| 체척업체담당자 | tailor_company | 맞춤피복 제작 관리 |
| 일반사용자 | general | 피복 구매 |

### 2.2 권한 매트릭스

| 기능 | admin | sales_office | tailor_company | general |
|------|:-----:|:------------:|:--------------:|:-------:|
| 사용자 관리 | ✅ | ❌ | ❌ | ❌ |
| 사용자 검색 | ✅ | ✅ | ✅ | ❌ |
| 포인트 지급 | ✅ | ❌ | ❌ | ❌ |
| 품목 관리 | ✅ | ❌ | ❌ | ❌ |
| 판매소 관리 | ✅ | ❌ | ❌ | ❌ |
| 체척업체 관리 | ✅ | ❌ | ❌ | ❌ |
| 체척권 취소 승인 | ✅ | ❌ | ❌ | ❌ |
| 주문 관리 | ✅ | ✅ | ❌ | ✅ (본인) |
| 오프라인 판매 | ✅ | ✅ | ❌ | ❌ |
| 반품 처리 | ✅ | ✅ | ❌ | ❌ |
| 재고 관리 | ✅ | ✅ | ❌ | ❌ |
| 배송지 관리 | ✅ | ✅ (본인) | ❌ | ✅ (조회) |
| 체척권 등록 | ❌ | ❌ | ✅ | ❌ |
| 피복 쇼핑 | ❌ | ❌ | ❌ | ✅ |
| 체척권 조회 | ✅ | ❌ | ✅ | ✅ (본인) |
| 통계 조회 | ✅ | ✅ | ✅ | ✅ |

---

## 3. 기능적 요구사항

### 3.1 인증 (AUTH)

#### AUTH-001 로그인
- 사용자는 아이디와 비밀번호로 로그인한다
- JWT 토큰 기반 인증
- 로그인 실패 시 오류 메시지 표시

#### AUTH-002 로그아웃
- 사용자는 로그아웃할 수 있다
- 토큰 무효화

#### AUTH-003 세션 관리
- 토큰 만료 시 자동 로그아웃
- 토큰 갱신 기능

---

### 3.2 사용자 관리 (USER)

#### USER-001 사용자 등록
- 관리자는 사용자를 개별 등록할 수 있다
- 필수 항목: 아이디, 비밀번호, 이름, 군번, 계급, 소속
- 아이디/군번 중복 검사

#### USER-002 사용자 일괄 등록
- 관리자는 엑셀 파일로 사용자를 일괄 등록할 수 있다
- 데이터 검증 및 오류 리포트 제공

#### USER-003 사용자 정보 수정
- 관리자는 사용자 정보를 수정할 수 있다
- 진급 처리 시 포인트 자동 조정

#### USER-004 사용자 검색
- 이름, 군번, 소속으로 사용자를 검색할 수 있다
- 권한별 접근 가능 범위 제한

#### USER-005 사용자 상태 관리
- 관리자는 사용자를 비활성화할 수 있다
- 비활성화된 사용자는 로그인할 수 없다

---

### 3.3 포인트 관리 (POINT)

#### POINT-001 포인트 지급
- 관리자는 사용자에게 포인트를 지급할 수 있다
- 지급 사유 필수 입력
- 지급 이력 자동 생성

#### POINT-002 일괄 지급
- 관리자는 전체/선택 사용자에게 일괄 지급할 수 있다
- 계급별 기본 포인트 적용
- 복무년수 보너스 자동 계산

#### POINT-003 포인트 조회
- 사용자는 본인의 포인트를 조회할 수 있다
- 보유/예약/사용가능 포인트 표시
- 포인트 이력 조회

#### POINT-004 마이너스 포인트 방지
- 모든 포인트 작업에서 마이너스 값을 허용하지 않는다
- 사용가능 포인트 = 보유 포인트 - 예약 포인트
- 구매 시 사용가능 포인트 범위 내에서만 가능

---

### 3.4 품목 관리 (ITEM)

#### ITEM-001 카테고리 관리
- 관리자는 피복 카테고리를 관리할 수 있다
- 3단계 계층 구조 (대/중/소분류)

#### ITEM-002 품목 등록
- 관리자는 피복 품목을 등록할 수 있다
- 완제품/맞춤피복 구분
- 완제품: 규격(사이즈)별 가격 설정
- 맞춤피복: 자동으로 '맞춤' 규격 생성

#### ITEM-003 품목 수정/삭제
- 관리자는 품목 정보를 수정할 수 있다
- 삭제 시 연관 데이터 검증

---

### 3.5 주문/구매 (ORDER)

#### ORDER-001 온라인 구매 (완제품)
- 사용자는 완제품을 온라인으로 구매할 수 있다
- 판매소 선택 → 품목/규격 선택 → 배송 방법 선택 → 주문
- 배송 방법: 택배 배송, 직접 배송

#### ORDER-002 온라인 구매 (맞춤피복)
- 사용자는 맞춤피복을 구매할 수 있다
- 구매 즉시 체척권 발행
- 체척권 번호로 체척업체에서 맞춤 제작

#### ORDER-003 오프라인 판매
- 판매소 담당자는 오프라인 판매를 처리할 수 있다
- 사용자 검색 → 품목 선택 → 포인트 차감 판매
- 구매 즉시 포인트 차감, 재고 차감

#### ORDER-004 주문 취소
- 사용자는 배송 전 주문을 취소할 수 있다
- 취소 시 예약 포인트 해제

#### ORDER-005 반품 요청
- 사용자는 배송 완료된 주문을 반품 요청할 수 있다
- 판매소에서 반품 승인 시 포인트 환불

#### ORDER-006 주문 상태 관리
- 주문 상태: pending → confirmed → processing → shipped → delivered → received
- 취소: cancelled
- 반품: returned → refunded

---

### 3.6 재고 관리 (INVENTORY)

#### INV-001 재고 조회
- 판매소 담당자는 재고를 조회할 수 있다
- 품목별, 규격별 재고 현황
- 가용 재고 = 재고 - 예약 수량

#### INV-002 입고 처리
- 판매소 담당자는 입고를 처리할 수 있다
- 입고 수량, 사유 입력

#### INV-003 재고 조정
- 판매소 담당자는 재고를 조정할 수 있다
- 조정 사유 필수 입력
- 조정 이력 자동 생성

---

### 3.7 체척권 관리 (VOUCHER)

#### VCH-001 체척권 발행
- 맞춤피복 구매 시 자동 발행
- 발행 즉시 포인트 차감
- 체척권 번호 자동 생성

#### VCH-002 체척권 등록
- 체척업체 담당자는 체척권을 등록할 수 있다
- 체척권 번호로 사용자 정보 확인
- 등록 후 '사용완료' 상태로 변경

#### VCH-003 체척권 취소 요청
- 사용자는 미사용 체척권의 취소를 요청할 수 있다
- 취소 요청 상태로 변경

#### VCH-004 체척권 취소 승인
- 관리자는 체척권 취소 요청을 승인/반려할 수 있다
- 승인 시: 포인트 환불, 체척권 취소 상태
- 반려 시: 원래 상태로 복구

---

### 3.8 배송지 관리 (DELIVERY)

#### DLV-001 배송지 등록
- 판매소 담당자는 직접 배송지를 등록할 수 있다
- 배송지명, 주소, 담당자 정보

#### DLV-002 배송지 관리
- 판매소 담당자는 배송지를 수정/삭제할 수 있다
- 비활성화 기능

---

### 3.9 통계 (STATS)

#### STAT-001 대시보드 통계
- 역할별 맞춤 통계 제공
- 관리자: 전체 현황
- 판매소: 판매 현황
- 체척업체: 체척권 현황
- 사용자: 구매 현황

#### STAT-002 판매 통계
- 판매소 담당자는 판매 통계를 조회할 수 있다
- 일별 판매 추이, 인기 상품, 카테고리별 비중

---

## 4. 포인트 처리 규칙

### 4.1 포인트 계산

```
연간 포인트 = 기본 포인트 + (복무년수 × 5,000P)
진급 시 추가 = (새 계급 포인트 - 구 계급 포인트) × (잔여일수 / 365)
```

### 4.2 포인트 처리 매트릭스

| 작업 | 보유 포인트 | 예약 포인트 | 사용가능 포인트 | 재고 |
|------|------------|------------|----------------|------|
| 온라인 구매 생성 | 유지 | +증가 | -감소 (검증) | 예약 +증가 |
| 온라인 구매 수령 | -차감 | -해제 | 유지 | -차감, 예약 -해제 |
| 온라인 구매 취소 | 유지 | -해제 | +복원 | 예약 -해제 |
| 오프라인 구매 | -차감 | 유지 | -감소 | -차감 |
| 반품 완료 | +복원 | 유지 | +증가 | +복원 |
| 체척권 발행 | -차감 | 유지 | -감소 | - |
| 체척권 취소 승인 | +복원 | 유지 | +증가 | - |

### 4.3 제약사항

1. 모든 포인트 값은 0 이상이어야 한다
2. `current_point >= reserved_point` 유지
3. `available_point >= 0` 유지
4. 구매 시 `사용가능 포인트 >= 주문 금액` 검증

---

## 5. 비기능적 요구사항

### 5.1 성능

- 페이지 로딩 시간 3초 이내
- API 응답 시간 1초 이내
- 동시 사용자 100명 지원

### 5.2 보안

- 비밀번호 암호화 (bcrypt)
- JWT 토큰 기반 인증
- 역할 기반 접근 제어 (RBAC)
- SQL Injection 방지

### 5.3 가용성

- 99% 가용성 목표
- 데이터 백업 (일일)

### 5.4 사용성

- 반응형 디자인
- 모바일 호환
- 직관적인 UI/UX

---

## 6. 데이터 요구사항

### 6.1 데이터 보관

| 데이터 | 보관 기간 | 비고 |
|--------|----------|------|
| 사용자 정보 | 영구 | 비활성화 후 5년 |
| 주문 정보 | 5년 | |
| 포인트 거래 | 5년 | |
| 체척권 | 5년 | 사용완료/취소 후 5년 |

### 6.2 데이터 무결성

- 외래키 제약 준수
- 참조 무결성 유지
- 트랜잭션 처리

---

## 7. 인터페이스 요구사항

### 7.1 API 인터페이스

- RESTful API
- JSON 데이터 형식
- HTTP 상태 코드 준수

### 7.2 UI 인터페이스

- 웹 브라우저 (Chrome, Firefox, Safari, Edge)
- 최신 2개 버전 지원

---

## 8. 제약사항

### 8.1 기술적 제약

- Backend: FastAPI, SQLAlchemy, SQLite
- Frontend: Vue 3, Vite, Pinia
- Python 3.11+, Node.js 18+

### 8.2 운영적 제약

- 내부망 운영
- 관리자 승인 프로세스

---

## 9. 요구사항 추적 매트릭스

| ID | 요구사항 | 우선순위 | 상태 | 비고 |
|----|---------|---------|------|------|
| AUTH-001 | 로그인 | 높음 | 완료 | |
| AUTH-002 | 로그아웃 | 높음 | 완료 | |
| USER-001 | 사용자 등록 | 높음 | 완료 | |
| USER-002 | 사용자 일괄 등록 | 높음 | 완료 | |
| USER-003 | 사용자 정보 수정 | 높음 | 완료 | |
| USER-004 | 사용자 검색 | 높음 | 완료 | |
| POINT-001 | 포인트 지급 | 높음 | 완료 | |
| POINT-002 | 일괄 지급 | 높음 | 완료 | |
| POINT-003 | 포인트 조회 | 높음 | 완료 | |
| POINT-004 | 마이너스 포인트 방지 | 높음 | 완료 | |
| ORDER-001 | 온라인 구매 (완제품) | 높음 | 완료 | |
| ORDER-002 | 온라인 구매 (맞춤피복) | 높음 | 완료 | |
| ORDER-003 | 오프라인 판매 | 높음 | 완료 | |
| ORDER-004 | 주문 취소 | 높음 | 완료 | |
| ORDER-005 | 반품 요청 | 높음 | 완료 | |
| INV-001 | 재고 조회 | 높음 | 완료 | |
| INV-002 | 입고 처리 | 높음 | 완료 | |
| INV-003 | 재고 조정 | 높음 | 완료 | |
| VCH-001 | 체척권 발행 | 높음 | 완료 | |
| VCH-002 | 체척권 등록 | 높음 | 완료 | |
| VCH-003 | 체척권 취소 요청 | 높음 | 완료 | |
| VCH-004 | 체척권 취소 승인 | 높음 | 완료 | |
| DLV-001 | 배송지 등록 | 중간 | 완료 | |
| STAT-001 | 대시보드 통계 | 중간 | 완료 | |
| STAT-002 | 판매 통계 | 중간 | 완료 | |

---

## 10. 승인

| 작성자 | 검토자 | 승인자 |
|--------|--------|--------|
| 개발팀 | | |

| 버전 | 일자 | 변경 내용 |
|------|------|----------|
| 1.0 | 2026-02-20 | 초기 작성 |
