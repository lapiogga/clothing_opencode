# 프로젝트 기획서

> 군 피복 구매관리 시스템 프로젝트 기획서

## 1. 프로젝트 개요

### 1.1 프로젝트명

군 피복 구매관리 시스템 (Military Clothing Purchase Management System)

### 1.2 프로젝트 목적

군 인원에게 지급되는 피복포인트를 체계적으로 관리하고, 온라인/오프라인 채널을 통한 피복 구매를 효율화하기 위한 통합 관리 시스템 구축

### 1.3 프로젝트 기간

- 기획: 2024년 1월
- 개발: 2024년 1월 ~ 진행중

### 1.4 개발 환경

| 구분 | 내용 |
|------|------|
| Backend | FastAPI 0.100+, Python 3.11+ |
| Frontend | Vue 3, Vite 5, Pinia |
| Database | SQLite |
| 개발도구 | VS Code, Git |

---

## 2. 요구사항 분석

### 2.1 사용자 유형별 기능

#### 2.1.1 군수담당자 (admin)

| 기능 | 설명 | 우선순위 |
|------|------|---------|
| 사용자 관리 | 일괄/개별 등록, 진급 처리 | 높음 |
| 포인트 관리 | 계급별 지급, 일할계산 | 높음 |
| 품목 관리 | 대/중/소분류, 품목 등록 | 높음 |
| 판매소 관리 | CRUD | 중간 |
| 체척업체 관리 | CRUD | 중간 |
| 체척권 승인 | 취소 요청 승인 | 중간 |
| 통계 조회 | 전체 현황 | 낮음 |

#### 2.1.2 피복판매소담당자 (sales_office)

| 기능 | 설명 | 우선순위 |
|------|------|---------|
| 주문 관리 | 배송 처리, 상태 변경 | 높음 |
| 오프라인 판매 | 직접 판매, 반품 | 높음 |
| 재고 관리 | 입고, 조정, 이력 | 높음 |
| 배송지 관리 | 직접 배송지 관리 | 중간 |
| 통계 | 판매 현황 | 낮음 |

#### 2.1.3 체척업체담당자 (tailor_company)

| 기능 | 설명 | 우선순위 |
|------|------|---------|
| 체척권 등록 | 사용자 체척권 등록 | 높음 |
| 현황 조회 | 등록된 체척권 목록 | 높음 |

#### 2.1.4 일반사용자 (general)

| 기능 | 설명 | 우선순위 |
|------|------|---------|
| 쇼핑 | 온라인 구매 | 높음 |
| 주문 관리 | 조회, 취소, 반품 | 높음 |
| 포인트 조회 | 보유, 이력 | 높음 |
| 내 정보 | 프로필 관리 | 중간 |

### 2.2 비즈니스 규칙

#### 2.2.1 포인트 지급 규칙

```
연간 포인트 = 기본 포인트 + (복무년수 × 5,000P)

진급 시 추가 포인트 = (새 계급 포인트 - 구 계급 포인트) × (잔여일수 / 365)
퇴직 시 포인트 = 연간 포인트 × (근무일수 / 365)
```

#### 2.2.2 주문/배송 규칙

| 상황 | 포인트 | 재고 |
|------|--------|------|
| 주문 생성 | reserved_point 증가 | reserved_quantity 증가 |
| 배송 완료 | current_point 차감, reserved_point 차감 | quantity 차감, reserved_quantity 차감 |
| 주문 취소 | reserved_point 차감 | reserved_quantity 차감 |
| 반품 완료 | current_point 증가 | quantity 증가 |

#### 2.2.3 체척권 규칙

- 맞춤피복 구매 시 자동 발급
- 체척업체 등록 전까지 취소 가능
- 등록 후 사용 완료까지 변경 불가

---

## 3. 시스템 설계

### 3.1 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────┐
│                    Presentation Layer                    │
│                    (Vue 3 + Vite)                        │
├─────────────────────────────────────────────────────────┤
│                    API Gateway Layer                     │
│                    (FastAPI Routers)                     │
├─────────────────────────────────────────────────────────┤
│                    Business Logic Layer                  │
│                    (Services)                            │
├─────────────────────────────────────────────────────────┤
│                    Data Access Layer                     │
│                    (SQLAlchemy ORM)                      │
├─────────────────────────────────────────────────────────┤
│                    Database Layer                        │
│                    (SQLite)                              │
└─────────────────────────────────────────────────────────┘
```

### 3.2 데이터베이스 설계

주요 테이블:

| 테이블 | 설명 | 레코드 수 (예상) |
|--------|------|-----------------|
| users | 사용자 | ~1,000 |
| ranks | 계급 | 10 |
| categories | 카테고리 | ~100 |
| clothing_items | 품목 | ~500 |
| clothing_specs | 규격 | ~2,000 |
| inventory | 재고 | ~6,000 |
| orders | 주문 | ~10,000/년 |
| order_items | 주문상세 | ~30,000/년 |
| point_transactions | 포인트거래 | ~20,000/년 |
| tailor_vouchers | 체척권 | ~500/년 |

### 3.3 API 설계

RESTful API 설계 원칙 준수

- 리소스 기반 URL 설계
- HTTP 메서드 활용 (GET, POST, PUT, DELETE)
- 역할별 엔드포인트 분리 (/api/orders vs /api/sales/orders)

---

## 4. 개발 현황

### 4.1 완료된 기능

| 기능 | 상태 | 비고 |
|------|------|------|
| 인증 시스템 | ✅ 완료 | JWT 토큰 |
| 사용자 관리 | ✅ 완료 | CRUD, 진급 |
| 계급 관리 | ✅ 완료 | 10개 계급 |
| 카테고리 관리 | ✅ 완료 | 3단계 계층 |
| 품목 관리 | ✅ 완료 | 규격 포함, 맞춤피복 자동 규격 생성 |
| 재고 관리 | ✅ 완료 | 판매소별 |
| 주문 시스템 | ✅ 완료 | 온라인/오프라인 |
| 포인트 시스템 | ✅ 완료 | 지급, 거래 |
| 체척권 시스템 | ✅ 완료 | 발급, 등록, 취소, 직접 발행 |
| 쇼핑 페이지 | ✅ 완료 | 품목별 그룹화, 맞춤피복 즉시 발권 |
| 오프라인 판매 | ✅ 완료 | 사용자 검색, 장바구니, 판매 처리 |
| 개발자 가이드 | ✅ 완료 | 개발 지침서 작성 |

### 4.2 진행 중인 기능

| 기능 | 상태 | 비고 |
|------|------|------|
| UI/UX 개선 | 🔄 진행중 | 컴팩트 디자인 |
| 통계 대시보드 | 🔄 진행중 | 데이터 연동 |

### 4.3 예정된 기능

| 기능 | 상태 | 우선순위 |
|------|------|---------|
| 알림 시스템 | 📋 예정 | 낮음 |
| 모바일 최적화 | 📋 예정 | 낮음 |
| 테스트 코드 | 📋 예정 | 중간 |

---

## 5. 변경 이력

### 5.1 주요 변경사항

| 일자 | 내용 | 영향도 |
|------|------|--------|
| 2024-01 | 필드 네이밍 통일 | 전체 |
| - employee_id → service_number | | |
| - department → unit | | |
| - points → current_point | | |
| 2024-01 | API 구조 개선 | Frontend |
| - /api/orders (사용자용) | | |
| - /api/sales/orders (판매소용) | | |
| 2024-01 | UI 리팩토링 | Frontend |
| - 컴팩트 리스트 디자인 | | |
| - 아코디언 상세 보기 | | |

### 5.2 데이터 필드 매핑

| 이전 명칭 | 현재 명칭 | 설명 |
|----------|----------|------|
| employee_id | service_number | 군번 |
| department | unit | 소속 |
| position | rank.name | 계급 |
| points | current_point | 보유 포인트 |
| employeeId | service_number | (Frontend) |
| department | unit | (Frontend) |

---

## 6. 테스트

### 6.1 테스트 계정

| ID | 비밀번호 | 역할 | 테스트 시나리오 |
|----|---------|------|----------------|
| admin | admin123 | 관리자 | 전체 관리 기능 |
| sales1 | sales123 | 판매소 | 주문, 재고 관리 |
| tailor1 | tailor123 | 체척업체 | 체척권 등록 |
| user01 | user123 | 일반 | 쇼핑, 주문 |

### 6.2 테스트 시나리오

#### 쇼핑 플로우

1. 사용자 로그인
2. 판매소 선택
3. 품목 선택 → 장바구니 담기
4. 배송 방법 선택
5. 주문 생성
6. 주문 확인

#### 배송 처리 플로우

1. 판매소 로그인
2. 주문 목록 조회
3. 주문 상태 변경 (→ 배송중 → 배송완료)
4. 운송장 번호 입력

---

## 7. 배포

### 7.1 개발 환경

```bash
# Backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# Frontend
npm run dev
```

### 7.2 프로덕션 환경 (예정)

```bash
# Backend
gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker

# Frontend
npm run build
# 정적 파일 서빙
```

---

## 8. 유지보수

### 8.1 로그

- FastAPI 기본 로그 사용
- 에러 로그 파일 저장

### 8.2 백업

- SQLite DB 정기 백업
- 코드: Git 저장소

---

## 9. 참고 문서

- [요구사항 정의서](../clothing_requirement.txt)
- [DB 스키마](db-schema.md)
- [API 명세서](api-spec.md)
- [화면설계서](ui-design.md)
- [AGENTS.md](../AGENTS.md) - 개발 가이드라인
